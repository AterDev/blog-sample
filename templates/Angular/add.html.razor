@* Add page template (single-file placement) *@
@{
    var name = ModelName ?? "Model";
}
<form [formGroup]="form" (ngSubmit)="submit()" class="add-form" style="display:flex;flex-direction:column;gap:16px;">

  @foreach (var p in AddPropertyInfos)
  {
    if (p.IsEnum)
    {
      <mat-form-field appearance="outline">
        <mat-label>@(p.CommentSummary ?? p.Name)</mat-label>
        <mat-select formControlName="@(p.Name.ToCamelCase())">
          <mat-option *ngFor="let opt of @(p.Type) | toKeyValue" [value]="opt.value">{{ opt.value | enumText:'@(p.Type)' }}</mat-option>
        </mat-select>
        <mat-error *ngIf="form.get('@(p.Name.ToCamelCase())')?.invalid && form.get('@(p.Name.ToCamelCase())')?.touched">{{ getValidatorMessage(form.get('@(p.Name.ToCamelCase())')) }}</mat-error>
      </mat-form-field>
    }
    else if (p.Type != null && p.Type.ToLower().Contains("bool"))
    {
      <mat-checkbox formControlName="@(p.Name.ToCamelCase())">@(p.CommentSummary ?? p.Name)</mat-checkbox>
      <div *ngIf="form.get('@(p.Name.ToCamelCase())')?.invalid && form.get('@(p.Name.ToCamelCase())')?.touched"><mat-error>{{ getValidatorMessage(form.get('@(p.Name.ToCamelCase())')) }}</mat-error></div>
    }
    else if (p.Type != null && p.Type.ToLower().Contains("date"))
    {
      <mat-form-field appearance="outline">
        <mat-label>@(p.CommentSummary ?? p.Name)</mat-label>
        <input matInput [matDatepicker]="@(p.Name.ToCamelCase())Picker" formControlName="@(p.Name.ToCamelCase())" />
        <mat-datepicker-toggle matSuffix [for]="@(p.Name.ToCamelCase())Picker"></mat-datepicker-toggle>
        <mat-datepicker #@(p.Name.ToCamelCase())Picker></mat-datepicker>
        <mat-error *ngIf="form.get('@(p.Name.ToCamelCase())')?.invalid && form.get('@(p.Name.ToCamelCase())')?.touched">{{ getValidatorMessage(form.get('@(p.Name.ToCamelCase())')) }}</mat-error>
      </mat-form-field>
    }
    else if (p.MaxLength.HasValue && p.MaxLength > 200)
    {
      <mat-form-field appearance="outline">
        <mat-label>@(p.CommentSummary ?? p.Name)</mat-label>
        <textarea matInput rows="4" formControlName="@(p.Name.ToCamelCase())"></textarea>
        <mat-error *ngIf="form.get('@(p.Name.ToCamelCase())')?.invalid && form.get('@(p.Name.ToCamelCase())')?.touched">{{ getValidatorMessage(form.get('@(p.Name.ToCamelCase())')) }}</mat-error>
      </mat-form-field>
    }
    else
    {
      <mat-form-field appearance="outline">
        <mat-label>@(p.CommentSummary ?? p.Name)</mat-label>
        <input matInput type="@(p.IsDecimal ? "number" : "text")" formControlName="@(p.Name.ToCamelCase())" />
        <mat-error *ngIf="form.get('@(p.Name.ToCamelCase())')?.invalid && form.get('@(p.Name.ToCamelCase())')?.touched">{{ getValidatorMessage(form.get('@(p.Name.ToCamelCase())')) }}</mat-error>
      </mat-form-field>
    }
  }

  <div style="display:flex;gap:8px;justify-content:flex-end;">
    <button mat-button type="button" (click)="close(false)">{{ i18nKeys.common.cancel | translate }}</button>
    <button mat-flat-button color="primary" type="submit" [disabled]="form.invalid">{{ i18nKeys.common.save | translate }}</button>
  </div>

</form>